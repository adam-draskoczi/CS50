CREATE TABLE users (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, username TEXT NOT NULL UNIQUE, hash TEXT NOT NULL UNIQUE, firstname TEXT NOT NULL, lastname TEXT NOT NULL, area TEXT NOT NULL, title TEXT NOT NULL, reg DATETIME);

CREATE TABLE batches (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name TEXT NOT NULL UNIQUE, comment TEXT, by INTEGER NOT NULL, created DATETIME, filling DATETIME, coating DATETIME, topping DATETIME, quality DATETIME, FOREIGN KEY (by) REFERENCES users (id));

CREATE TABLE bonbons (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, batch INTEGER NOT NULL, box INTEGER NOT NULL, line INTEGER NOT NULL, FOREIGN KEY (batch) REFERENCES batches (id));

CREATE TABLE processes (batch INTEGER NOT NULL, box INTEGER NOT NULL, process TEXT NOT NULL, temp REAL NOT NULL, type TEXT NOT NULL, comment TEXT, by INTEGER NOT NULL, datetime DATETIME, FOREIGN KEY (batch) REFERENCES batches (id), FOREIGN KEY (by) REFERENCES users (id));

CREATE TABLE inspections (bonbon INTEGER NOT NULL, defect TEXT NOT NULL, by INTEGER NOT NULL, datetime DATETIME, FOREIGN KEY (bonbon) REFERENCES bonbons (id), FOREIGN KEY (by) REFERENCES users (id));